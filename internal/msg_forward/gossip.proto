syntax = "proto3";

package rpc;
option go_package="./rpc";

service GossipService {
  rpc PropagateGossip (GossipMessage) returns (GossipResponse);
  rpc PullState (PullRequest) returns (PullResponse);
}

message GossipMessage {
  int32 source_node = 1;
  map<string, NodeState> state_map = 2;
}

message GossipResponse {
  string ack = 1;
}

message PullRequest {
  int32 requester_node = 1;
}

message PullResponse {
  map<int32, NodeState> state_map = 1;
}

message NodeState {
  int32 node_id = 1;
  map<int32, int32> status = 2;
  int64 version = 3;
  string last_update = 4;
}